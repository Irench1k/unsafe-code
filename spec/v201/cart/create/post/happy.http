# @import ../_imports.http

# POST /cart happy path
# Cart creation across auth methods
#
# Exports (for @forceRef by other tests):
#   new_cart - Patrick's cart (canonical fixture)

### Create cart with Basic Auth (canonical fixture for downstream tests)
# @name new_cart
# @tag cart, happy, r02, v201
POST /cart
Authorization: {{auth.basic("patrick")}}

@cart_id = {{$(response).field("cart_id")}}
?? js $(response).status() == 201
?? js $(response).hasFields("cart_id", "items") == true

### Create cart with Cookie Auth
# @name cart_created
# @tag cart, happy, r02, v201
POST /cart
Cookie: {{auth.login("patrick")}}

?? js $(response).status() == 201
?? js $(response).hasFields("cart_id", "items") == true

### Create cart for different user (plankton)
# @tag cart, happy, r02, v201
POST /cart
Authorization: {{auth.basic("plankton")}}

@cart_id_plankton = {{$(response).field("cart_id")}}
?? js $(response).status() == 201
?? js $(response).hasFields("cart_id", "items") == true
