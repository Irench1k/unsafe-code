# @import ../_imports.http

# GET /account/info happy path
# Covers Basic Auth and Cookie Auth

### Basic Auth returns full account info
# @name info_basic_auth
{{
  await platform.seedCredits("plankton", 200);
  await platform.seedCredits("spongebob", 150);
}}
# @tag account, happy, r02, v201
GET /account/info
Authorization: {{auth.basic("plankton")}}

?? js $(response).isOk() == true
?? js $(response).hasFields("balance", "email", "name") == true
?? js $(response).field("email") == {{user("plankton").email}}
?? js $(response).field("name") == {{user("plankton").displayName}}
?? js Number($(response).field("balance")) == 200

### Cookie Auth returns full account info
# @forceRef info_basic_auth
# @tag account, happy, r02, v201
GET /account/info
Cookie: {{auth.login("spongebob")}}

?? js $(response).isOk() == true
?? js $(response).hasFields("balance", "email", "name") == true
?? js $(response).field("email") == {{user("spongebob").email}}
?? js $(response).field("name") == {{user("spongebob").displayName}}
?? js Number($(response).field("balance")) == 150
