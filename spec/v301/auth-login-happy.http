# @import ../common.http

# POST /auth/login happy path
# Tests successful login flow

# =============================================================================
# SUCCESSFUL LOGIN
# =============================================================================

### Login with valid credentials returns session cookie
{{
  await platform.reset();
}}
# @tag ci, r03, vulnerable
POST /auth/login
Content-Type: application/json

{
  "email": "{{user("spongebob").email}}",
  "password": "{{user("spongebob").password}}"
}

?? js $(response).isOk() == true
?? js $(response).hasFields("email", "message") == true
?? js $(response).field("email") == {{user("spongebob").email}}
?? js $(response).field("message") == Login successful
?? js extractCookie(response) != null == true
