# @import ../common.http

# GET /account/credits happy path
# Tests both Basic Auth and Cookie Auth methods

# =============================================================================
# AUTHENTICATION METHODS
# =============================================================================

### Basic Auth returns user's balance
{{
  await platform.seed({
    plankton: 200,
    squidward: 150
  });
}}
# @tag ci, r03, vulnerable
GET /account/credits
Authorization: {{auth.basic("plankton")}}

?? js $(response).isOk() == true
?? js $(response).hasFields("balance", "email") == true
?? js $(response).field("email") == {{user("plankton").email}}
?? js $(response).field("balance") == 200.00

### Cookie Auth returns user's balance
# @tag ci, r03, vulnerable
GET /account/credits
Cookie: {{auth.login("squidward")}}

?? js $(response).isOk() == true
?? js $(response).hasFields("balance", "email") == true
?? js $(response).field("email") == {{user("squidward").email}}
?? js $(response).field("balance") == 150.00
