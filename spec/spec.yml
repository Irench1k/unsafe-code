# E2E Spec Suite Configuration
# Lean format with implicit inheritance
#
# File naming:
#   - New specs: {name}.http (stored in git)
#   - Inherited: ~{name}.http (generated via `uv run spec-sync generate`)
#
# Version format:
#   inherits: vXXX          # inherit all specs from parent version
#   exclude: [...]          # don't inherit these specs from parent
#   specs: [...]            # new specs defined in this version
#
# Run `uv run spec-sync status` to see current state

# =============================================================================
# Authorization Confusion (r03)
# =============================================================================

v301:
  description: "Dual-Auth Refund Approval"
  tags: [r03, vulnerable]
  specs:
    # /account
    - account-credits-get-guardrails
    - account-credits-get-happy
    - account-credits-post-guardrails
    - account-credits-post-happy
    - account-info-get-guardrails
    - account-info-get-happy
    # /auth
    - auth-login-guardrails
    - auth-login-happy
    - auth-logout-happy
    - auth-register-guardrails
    - auth-register-happy
    # /cart
    - cart-checkout-happy
    - cart-checkout-ownership
    - cart-checkout-params
    - cart-checkout-reuse
    - cart-create-guardrails
    - cart-create-happy
    - cart-items-guardrails
    - cart-items-happy
    # /menu
    - menu-get-happy
    # /orders
    - orders-list-guardrails
    - orders-list-happy
    - orders-refund-post-guardrails
    - orders-refund-post-happy
    - orders-refund-status-guardrails
    - orders-refund-status-happy
    - orders-status-guardrails
    - orders-status-happy
    # /restaurants
    - restaurants-list-happy
    # Vulnerability
    - vuln-dual-auth-refund
