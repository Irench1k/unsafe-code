# @import ../common/setup.http
@base = {{base_host}}/v302

### Plankton checks his balance before ordering
# @name initial_balance
GET {{base}}/account/info
Authorization: {{plankton_auth}}

### He creates a cart with an expensive $50 meal
# @name expensive_cart
POST {{base}}/cart?restaurant_id=1
Authorization: {{plankton_auth}}

###
POST {{base}}/cart/{{expensive_cart.cart_id}}/items
Authorization: {{plankton_auth}}
Content-Type: application/json

{ "item_id": "5" }

### Then he creates another cart with a cheap $6 side without checking it out the expensive cart
# @name cheap_cart
POST {{base}}/cart?restaurant_id=1
Authorization: {{plankton_auth}}

###
POST {{base}}/cart/{{cheap_cart.cart_id}}/items
Authorization: {{plankton_auth}}
Content-Type: application/json

{ "item_id": "2" }

### Plankton sends a confusing checkout request, with a cheapcart still in session, but an expensivecart in /<cart_id>/
POST {{base}}/cart/{{expensive_cart.cart_id}}/checkout
Authorization: {{plankton_auth}}
Content-Type: application/json

{
  "tip": "0",
  "delivery_address": "Chum Bucket"
}

?? status == 201

### But he was only charged for the cheap cart from his session
GET {{base}}/account/info
Authorization: {{plankton_auth}}