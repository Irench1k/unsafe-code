# @import ../common/setup.http
@host = {{base_host}}/v307

# Plankton discovers he can hijack ANY restaurant using his own domain token

###
# `@restaurant_owner`
PATCH /restaurants/1
Authorization: {{plankton_auth}}
Content-Type: application/json

{
    "name": "Krusty Krabs",
    "description": "Krusty Krabs is closing due to a salmonella outbreak!!!",
    "domain": "chum-bucket.sea"
}

@token = {{mailpit.lastEmail("admin@chum-bucket.sea").userToken()}}
?? status == 200

###
# `@restaurant_owner`
PATCH /restaurants/2
Authorization: {{plankton_auth}}
Content-Type: application/json

{
    "name": "Krusty Krabs",
    "description": "Krusty Krabs is closing due to a salmonella outbreak!!!",
    "domain": "chum-bucket.sea",
    "token": "{{token}}"
}

?? status == 200

### 
GET /restaurants