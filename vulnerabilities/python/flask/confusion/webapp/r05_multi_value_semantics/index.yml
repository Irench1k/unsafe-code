version: '1'
root: .
category: ii.multi-value-semantics
namespace: flask-ii-multi-value-semantics
examples:
  1:
    id: 1
    kind: block
    title: '[Not Vulnerable] First Item Checked, First Item Used'
    notes: >-
      This example is not vulnerable and is meant to demonstrate how the vulnerability could
      realistically get added to the codebase during refactoring.


      We start by implementing a helper function `@check_group_membership` that checks that
      the user is a member of the group which messages are being accessed.
    http: null
    language: python
    parts:
    - part: 1
      file: routes.py
      code_start_line: 18
      code_end_line: 23
    - part: 2
      file: decorator.py
      code_start_line: 24
      code_end_line: 33
    file_hashes:
      decorator.py: 6be641fe0661a5c3a9a9a23d20539d4bb777d03a71b5b1db66a84582ff39022d
      routes.py: e78995ea8da74d11fec1826ca86217f127979625190ed3d8a4d3acccca1bc5e8
    fingerprint: d887e136a8c666b4f614b47fce00a946308255f0888bbec8da4d1b71f87b6c62
  2:
    id: 2
    kind: block
    title: Utility Reuse Mismatch — .get vs .getlist
    notes: >-
      Builds upon the previous example. Consider that we need to add a new API endpoint that
      allows the user to access the messages of multiple groups in a single request.


      We start by copying the previous implementation and changing the function body to iterate
      over all the groups in the request.


      The code looks clean and works nicely for the "happy path", but it is vulnerable as
      the function body now acts on the unverified data – remember that `@check_group_membership`
      only checks the first group in the request.
    http: null
    language: python
    parts:
    - part: 1
      file: routes.py
      code_start_line: 41
      code_end_line: 49
    file_hashes:
      routes.py: e78995ea8da74d11fec1826ca86217f127979625190ed3d8a4d3acccca1bc5e8
    fingerprint: 2e5725fa747458305fce88c408f0342022f0ace5630b0b26ce26f9dd4822f659
  3:
    id: 3
    kind: block
    title: Any vs All — Fail-Open Authorization for Batch Actions
    notes: >-
      Authorization incorrectly uses `any()` over the requested groups, allowing a user who
      is an admin of one group to grant membership for additional groups in the same request.
      The action then applies to every provided group. Correct behavior would require `all()`.
    http: null
    language: python
    parts:
    - part: 1
      file: routes.py
      code_start_line: 61
      code_end_line: 68
    - part: 2
      file: decorator.py
      code_start_line: 41
      code_end_line: 50
    file_hashes:
      decorator.py: 6be641fe0661a5c3a9a9a23d20539d4bb777d03a71b5b1db66a84582ff39022d
      routes.py: e78995ea8da74d11fec1826ca86217f127979625190ed3d8a4d3acccca1bc5e8
    fingerprint: 025d8ee22b63549e1428b368958a80d3db0ad99c5f8e6f9c4b5d1b565e293816
attachments:
  http/exploit-1.http: ee938b2befaaf9e229ceb8dd62ce9fffb15f43c18826ad6556ce8baeb2c5d008
  http/exploit-2.http: 0361b888b39e1a6a318eac54fe3689b6cdeafb4a825947bf4bf2fe5e12b379f7
  http/exploit-3.http: 52aeed3b926df50fd4b05318d6f4e731816dd523a0e0f1662c0245bd2615455f
build_signature: 4dc24099f0d6e2ae4e21962e32e43086da8dcb496a284704839dddfba9c98961
last_readme_fingerprint: 5193e4104af2f839a6791bd9221bc09aa7727363d31ec532364a90d885ba8443
