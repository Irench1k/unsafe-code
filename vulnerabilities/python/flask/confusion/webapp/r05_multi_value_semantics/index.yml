version: '1'
root: .
category: ii.multi-value-semantics
namespace: flask-ii-multi-value-semantics
examples:
  1:
    id: 1
    kind: block
    title: '[Not Vulnerable] First Item Checked, First Item Used'
    notes: >-
      This example is not vulnerable and is meant to demonstrate how the vulnerability could
      realistically get added to the codebase during refactoring.


      We start by implementing a helper function `@check_group_membership` that checks that
      the user is a member of the group which messages are being accessed.
    http: null
    language: python
    parts:
    - part: 1
      file: routes.py
      code_start_line: 18
      code_end_line: 23
    - part: 2
      file: decorator.py
      code_start_line: 24
      code_end_line: 33
    file_hashes:
      decorator.py: 0fcb817592c2f9a8297d2698259a06e2b82efc47cad7d438e3a80291f01bb6c4
      routes.py: ecd6e8b1ea2cbd1419fa23d5f97b6a046dbeb2b0178f5cce00d2f415a82866d8
    fingerprint: a5946e19f21abfd0c945f6d7c5f8067e755bd6dd4c9a61f6e9e90092abec5881
  2:
    id: 2
    kind: block
    title: Utility Reuse Mismatch — .get vs .getlist
    notes: >-
      Builds upon the previous example. Consider that we need to add a new API endpoint that
      allows the user to access the messages of multiple groups in a single request.


      We start by copying the previous implementation and changing the function body to iterate
      over all the groups in the request.


      The code looks clean and works nicely for the "happy path", but it is vulnerable as
      the function body now acts on the unverified data – remember that `@check_group_membership`
      only checks the first group in the request.
    http: null
    language: python
    parts:
    - part: 1
      file: routes.py
      code_start_line: 41
      code_end_line: 49
    file_hashes:
      routes.py: ecd6e8b1ea2cbd1419fa23d5f97b6a046dbeb2b0178f5cce00d2f415a82866d8
    fingerprint: 3cb759deb88ab3c5a4ae5eb20dc513b214e01b3b0cf6a18a2f71767d1ecf0107
  3:
    id: 3
    kind: block
    title: Any vs All — Fail-Open Authorization for Batch Actions
    notes: >-
      Authorization incorrectly uses `any()` over the requested groups, allowing a user who
      is an admin of one group to grant membership for additional groups in the same request.
      The action then applies to every provided group. Correct behavior would require `all()`.
    http: null
    language: python
    parts:
    - part: 1
      file: routes.py
      code_start_line: 61
      code_end_line: 68
    - part: 2
      file: decorator.py
      code_start_line: 41
      code_end_line: 50
    file_hashes:
      decorator.py: 0fcb817592c2f9a8297d2698259a06e2b82efc47cad7d438e3a80291f01bb6c4
      routes.py: ecd6e8b1ea2cbd1419fa23d5f97b6a046dbeb2b0178f5cce00d2f415a82866d8
    fingerprint: a384e62c644ebeaba838bf67d4baac7b8d2ad2e749112ebbf7c9d29061fe7565
attachments:
  http/exploit-1.http: cf659e1f1f69e27eb9c56c0b558f43e2c3fb69e09586bb2b35e3d42afac1e5cd
  http/exploit-2.http: 1c58e7e81c8aa0406eae27a01d4554c0f970ad182f13745f542b97d063f48c83
  http/exploit-3.http: ecff44fe25c4e36dcfec20802f8c6ef8fe117b73f4ca7f27829f231a56fa110a
build_signature: 6ce8e42849f18c984bce41bf4346528541115bbae30096e5fe0cc232df07d69e
last_readme_fingerprint: 283c397722ba9d908ccd54baea9b018b4f9ad1d95280c709ec127c3d835d5e82
