version: '1'
root: .
category: ii.http-semantics
namespace: flask-ii-http-semantics
examples:
  1:
    id: 1
    kind: block
    title: HTTP Method Confusion — GET With Body Triggers Update Without Auth
    notes: >-
      A complicated controller for a groups API. Lists groups, returns group messages and
      posts new messages to a group.


      The code processes both GET and POST requests, but lacks explicit method checks. This
      introduces a vulnerability due to incorrect assumptions.


      The group membership check is performed in the `@check_group_membership` decorator,
      which checks the `group` argument – if present – in the request.values. The developer
      intent was to support passing the `group` argument via query string in GET requests,
      as well as via form argument in POST requests, and also support GET requests without
      the `group` argument.


      However, since the code does not enforce this and lacks explicit method checks, it also
      supports GET requests with the `group` argument in the form body (Flask supports GET
      requests with the body, and will parse this data in `request.form` by default).


      At the same time, `request.values` used in the `@check_group_membership` decorator ignores
      the form data on GET requests, leading to a confusion vulnerability.
    http: null
    language: python
    parts:
    - part: 1
      file: routes.py
      code_start_line: 31
      code_end_line: 64
    - part: 2
      file: decorator.py
      code_start_line: 30
      code_end_line: 39
    file_hashes:
      decorator.py: 13a13773be4a2cc2693e73b21753fc4b0f6be2f598af91fcde09b52b9dab1577
      routes.py: 09710b1fc9d2f4482343b326748a5b5a14fcad38da9f4868cc4231acfdfdb463
    fingerprint: 4a7bd1a0e96d5d2458242640d30ccfc58995a8d377ef1220ca0d7d096e1d73e9
attachments:
  http/exploit-1.http: bff399de93b2522430236c888838bfa35ffe232ade388392199d7e37f6516e6d
build_signature: 150f977af26aa4ca71a17002d0731f2ecedea9689fcc4227ce59884ff75e7316
last_readme_fingerprint: 0d88c1cdb808b420822363bd658507949ebff7ae93337e5054651db438390614
