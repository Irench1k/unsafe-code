---
title: Cross-Component Parsing Drift in Flask
summary: |
  Decorators, middleware, and helpers sometimes grab request data before the view does; if each layer resolves parameters differently, the same call holds two meanings.
description: |
  ## Overview
  Flask's architecture allows each layer (decorators, middleware, before-request hooks, views) to independently choose how to source request data from multiple APIs: `request.args`, `request.form`, `request.values`, or `request.view_args`. When layers use different APIs or apply different merging strategies (e.g., args-priority vs form-priority), the same HTTP request carries multiple semantic interpretations. The guard validates one parameter value while the handler acts on another, enabling authorization bypasses even when all components execute in correct order.

  **Spotting the issue:**
  - Audit every decorator or middleware applied to a route and see which request APIs they touch (`request.args` vs `request.form` vs `request.values` vs `request.view_args`).
  - Check for custom merging logic that prioritizes sources differently (e.g., `request.args or request.view_args` vs direct function parameter binding).
  - Be suspicious when global state (e.g. `g.*`) is set in one layer but components still access raw request sources directly.
  - Verify decorators and handlers agree on which parameter source is authoritative for security decisions.
category: ii.cross-component-parse
namespace: flask-ii-cross-component-parse
toc: true
outline:
  - title: Shared Contract Baseline
    description: |
      A safe reference flow where decorators and views agree on how the group identifier is sourced.
    examples:
      - 13
  - title: Decorators That Drift
    description: |
      Guards implemented as decorators merge or prioritize request data differently than the view, enabling bypasses.
    examples:
      - 8
      - 14
      - 15
  - title: Middleware Short-Circuiting Views
    description: |
      Before-request hooks authenticate on query parameters only, while views consume form data.
    examples:
      - 9
