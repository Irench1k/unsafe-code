version: '1'
root: .
category: ii.multi-value-semantics
namespace: flask-ii-multi-value-semantics
examples:
  10:
    id: 10
    kind: block
    title: '[Not Vulnerable] First Item Checked, First Item Used'
    notes: >-
      This example is not vulnerable and is meant to demonstrate how the vulnerability could
      realistically get added to the codebase during refactoring.


      We start by implementing a helper function `@check_group_membership` that checks that
      the user is a member of the group which messages are being accessed.
    http: null
    language: python
    parts:
    - part: 1
      file: routes.py
      code_start_line: 18
      code_end_line: 23
    - part: 2
      file: decorator.py
      code_start_line: 24
      code_end_line: 33
    file_hashes:
      decorator.py: 5b9dc1d870580b8529d9914a2f8578385f14f3d3fe51d35f2320028ad773765a
      routes.py: e1dd25f8826c3ac3f78c3589641ebd8b6bebf3d3610171a546287169c8a4bcb6
    fingerprint: 05de248ceddd68b9e9e44a5eaa9ee35928539d45fa79e0cac3a4091c7a408f9c
  11:
    id: 11
    kind: block
    title: Utility Reuse Mismatch — .get vs .getlist
    notes: >-
      Builds upon the previous example. Consider that we need to add a new API endpoint that
      allows the user to access the messages of multiple groups in a single request.


      We start by copying the previous implementation and changing the function body to iterate
      over all the groups in the request.


      The code looks clean and works nicely for the "happy path", but it is vulnerable as
      the function body now acts on the unverified data – remember that `@check_group_membership`
      only checks the first group in the request.
    http: null
    language: python
    parts:
    - part: 1
      file: routes.py
      code_start_line: 41
      code_end_line: 49
    file_hashes:
      routes.py: e1dd25f8826c3ac3f78c3589641ebd8b6bebf3d3610171a546287169c8a4bcb6
    fingerprint: 2e9274c4ce51839cb460eded35820cca0fc74170cbc865d7863ac226e70c3ac1
  12:
    id: 12
    kind: block
    title: Any vs All — Fail-Open Authorization for Batch Actions
    notes: >-
      Authorization incorrectly uses `any()` over the requested groups, allowing a user who
      is an admin of one group to grant membership for additional groups in the same request.
      The action then applies to every provided group. Correct behavior would require `all()`.
    http: null
    language: python
    parts:
    - part: 1
      file: routes.py
      code_start_line: 61
      code_end_line: 68
    - part: 2
      file: decorator.py
      code_start_line: 41
      code_end_line: 50
    file_hashes:
      decorator.py: 5b9dc1d870580b8529d9914a2f8578385f14f3d3fe51d35f2320028ad773765a
      routes.py: e1dd25f8826c3ac3f78c3589641ebd8b6bebf3d3610171a546287169c8a4bcb6
    fingerprint: 97a9abdc2867f8ac1c5ca57efa0fc020503ca02271301cebb32924c776cba143
attachments:
  http/exploit-10.http: d86f6d1cd67232549d0a7788d4ad941a67e5a5918896d20e58ce2ecc51430b73
  http/exploit-11.http: b1d5f6a6fb4269f768ede287500c31261d9a44d71e7e8cf5fe6d0b2636b8013b
  http/exploit-12.http: 62434ff6fb11bb543c81f427239428d3af84e67ec3d0826c4eb5765d6e9e8100
build_signature: a9d52abe11c8e6339e5b189c7bef69a4be7611c20246e7aa398b28421a8c7cd8
last_readme_fingerprint: 425b7cf41af60cb9de58d3a43e1e0cac659b9dd7b21427d7b87bce21b5c2d8b3
