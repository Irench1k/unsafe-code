---
title: Parameter Source Confusion Vulnerabilities in Flask
summary: |
  This directory contains examples demonstrating various patterns of parameter source confusion vulnerabilities in Flask applications. These examples show how mixing different parameter sources (query strings, form data, and request.values) can lead to security vulnerabilities.
description: |
  ## Overview
  Parameter source confusion occurs when an application retrieves the same parameter from different sources in different parts of the code. This can lead to security vulnerabilities when authentication and data access use different sources for the same parameter.

  Here you can find several examples on how Flask framework design allows those vulnerabilities to be present.
category: confusion.parameter-source
namespace: flask-vuln-confusion-parameter-source
toc: true
outline:

  - title: "Secure Baseline"
    examples:
      - 0

  - title: "Simplified Vulnerability Patterns"
    examples:
      - 1
      - 2
      - 3

  - title: "Source Merging in Custom Helper Function"
    description: |
      The examples 1-3 are realistic and some are hard to detect, but there are still two issues with it:

      1. The situation is unlikely to occur in exactly this way, because here
         the request doesn't work at all if the `user` gets passed only via the query string (it HAS to pass two `user` values, through query string and the body argument).

      ![alt text](images/image-source-merging.png)

      2. The second issue is that while calling verification function explicitly is valid, a more common pattern is either using a decorator or a middleware.

      Let's see how we can resolve those issues.
    examples:
      - 4
      - 5

  - title: "Request.values Confusion"
    examples:
      - 6
      - 7

  - title: "Decorator-based Authentication"
    examples:
      - 8

  - title: "Middleware-based Authentication"
    examples:
      - 9

  - title: "Multi-Value Parameters"
    examples:
      - 11
      - 12
      - 13