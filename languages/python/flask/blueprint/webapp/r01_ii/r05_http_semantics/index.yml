version: '1'
root: .
category: ii.http-semantics
namespace: flask-ii-http-semantics
examples:
  1:
    id: 1
    kind: block
    title: HTTP Method Confusion — GET With Body Triggers Update Without Auth
    notes: >-
      A complicated controller for a groups API. Lists groups, returns group messages and
      posts new messages to a group.


      The code processes both GET and POST requests, but lacks explicit method checks. This
      introduces a vulnerability due to incorrect assumptions.


      The group membership check is performed in the `@check_group_membership` decorator,
      which checks the `group` argument – if present – in the request.values. The developer
      intent was to support passing the `group` argument via query string in GET requests,
      as well as via form argument in POST requests, and also support GET requests without
      the `group` argument.


      However, since the code does not enforce this and lacks explicit method checks, it also
      supports GET requests with the `group` argument in the form body (Flask supports GET
      requests with the body, and will parse this data in `request.form` by default).


      At the same time, `request.values` used in the `@check_group_membership` decorator ignores
      the form data on GET requests, leading to a confusion vulnerability.
    http: null
    language: python
    parts:
    - part: 1
      file: routes.py
      code_start_line: 31
      code_end_line: 64
    - part: 2
      file: decorator.py
      code_start_line: 30
      code_end_line: 39
    file_hashes:
      decorator.py: 6d1e92b0a00dee266da588e93aaaaf4ffe90ef6b2fab99f20f34168f3698a5f5
      routes.py: 057f7eceee67c8ceb6266160f61fe63d8acb77d4459c7b0d491ad6171f73ebf1
    fingerprint: ebedbfd695b1e64c0e8b8c1be6e10311073890220c2f03f96ee1d72b4e739d98
attachments:
  http/exploit-1.http: fbb2e7bcd00deef57ec3161044c5186bb73279a8a484eb889ee869cf9ce9a094
build_signature: a30d972c232a3dbca6c75545b610177dd9fe0500c23e9409ec483fcc17307cac
last_readme_fingerprint: 0cd06da20f0c4234ae01dc436e45771776a8f51c0586e5ba8cdb59425c7321c2
