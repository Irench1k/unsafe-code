---
title: Source Precedence Drift in Flask
summary: |
  When authentication trusts one request container and the handler trusts another, attackers can swap values between query strings, form bodies, JSON, or path params.
description: |
  ## Overview
  Source precedence bugs creep in when two parts of the stack read the "same" input from different sources. Flask makes this easy: query strings, HTML form bodies, JSON payloads, and path parameters each land in different containers, and helpers like `request.values` silently merge them with their own priority rules.

  **Common causes:**
  - Security code in decorators or helpers reads from `request.args` while the view trusts `request.form` or `request.get_json()`.
  - Refactors that move from query parameters to JSON do not update the guard.
  - Tests rarely cover both body and query variants, so the inconsistency remains hidden until production.

  **Review checklist:**
  1. Identify every lookup of the relevant key (e.g. `user`, `group`, `account_id`).
  2. Note whether it comes from `.args`, `.form`, `.view_args`, `.json`, or `.values`.
  3. Confirm the security decision and the business logic read from the same place, or explicitly reconcile them before use.
category: ii.source-precedence
namespace: flask-ii-source-precedence
toc: true
outline:
  - title: Secure Baselines
    description: |
      Consistent usage keeps authentication and data access aligned - use these to understand the intended flow before exploring the vulnerable variants.
    examples:
      - 1
  - title: Straightforward Source Drift
    description: |
      Simple handlers where the guard inspects query parameters but the action trusts form data or vice versa.
    examples:
      - 2
      - 3
      - 4
  - title: Helper-Induced Mixing
    description: |
      Utility functions that merge sources (or hide precedence rules) create subtle inconsistencies developers rarely spot in review.
    examples:
      - 5
      - 6
  - title: request.values Footguns
    description: |
      `request.values` promises convenience but applies its own precedence rules, leading to silent bypasses when paired with explicit `.args` or `.form` lookups.
    examples:
      - 7
      - 8
