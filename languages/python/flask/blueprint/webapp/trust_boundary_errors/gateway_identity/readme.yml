---
title: Gateway Injected Identity
summary: |
  Some deployments expect an API gateway to inject headers like `X-User-Id`; if the app accepts those values directly from clients, anyone can impersonate another user.
description: |
  ## Overview
  Service meshes and API gateways often add identity headers after mutual TLS or token verification. When a Flask service bypasses those layers in local testing, the code may start trusting those headers even when traffic comes directly from the public internet. The result is instant privilege escalation: supply the header and you are logged in as someone else.

  **Practice tips:**
  - Require the presence of a gateway-issued signature or mTLS client cert before consuming identity headers.
  - Consider enforcing header allowlists in middleware so accidental use of privileged headers is easy to spot.
  - Offer a local development shim that clearly distinguishes "mocked" identity from production behavior.
category: trust-boundary-errors.gateway-identity
namespace: flask-trust-boundary-gateway-identity
toc: true
outline: []
