# Flask Framework Metadata
# This file contains additional metadata for organizing and indexing examples

framework:
  name: "Flask"
  language: "Python"
  version: "2.3"
  website: "https://flask.palletsprojects.com/"
  description: "A lightweight WSGI web application framework"

categories:
  routing:
    title: "Routing & URL Handling"
    description: "Various patterns for defining and handling URL routes"
    examples:
      - id: "basic-routing"
        title: "Basic Static Routes"
        path: "/demo/routing/basic"
        difficulty: "beginner"
        tags: ["static", "get", "post"]
        description: "Simple route definition patterns"
        security_notes: "Static routes are generally safe but may expose sensitive endpoints"

      - id: "dynamic-routing"
        title: "Dynamic Routes with Parameters"
        path: "/demo/routing/dynamic"
        difficulty: "beginner"
        tags: ["dynamic", "url-parameters", "variables"]
        description: "Routes with variable URL components"
        security_notes: "URL parameters should be validated and sanitized"

      - id: "route-converters"
        title: "Built-in Route Converters"
        path: "/demo/routing/converters"
        difficulty: "intermediate"
        tags: ["converters", "type-conversion", "int", "float"]
        description: "Automatic type conversion for URL parameters"
        security_notes: "Built-in converters provide basic validation but may not prevent all attacks"

  data_access:
    title: "Request Data Access"
    description: "Different ways to access request data from various sources"
    examples:
      - id: "query-parameters"
        title: "Query String Parameters"
        path: "/demo/data-access/query"
        difficulty: "beginner"
        tags: ["get", "query-string", "args"]
        description: "Accessing URL query parameters"
        security_notes: "Query parameters can be manipulated by attackers"

      - id: "form-data"
        title: "Form Data Handling"
        path: "/demo/data-access/form"
        difficulty: "beginner"
        tags: ["post", "form", "multipart"]
        description: "Processing form submissions"
        security_notes: "Form data should be validated and sanitized"

      - id: "json-requests"
        title: "JSON Request Bodies"
        path: "/demo/data-access/json"
        difficulty: "intermediate"
        tags: ["json", "api", "rest"]
        description: "Handling JSON API requests"
        security_notes: "JSON data should have type validation"

      - id: "merged-sources"
        title: "Merged Data Sources"
        path: "/demo/data-access/merged"
        difficulty: "advanced"
        tags: ["values", "priority", "confusion"]
        description: "Understanding request.values merging behavior"
        security_notes: "HIGH RISK: Can lead to parameter confusion attacks"

vulnerabilities:
  confusion:
    title: "Data Source Confusion"
    description: "Vulnerabilities arising from ambiguous data source handling"
    examples:
      - id: "args-form-confusion"
        title: "request.args vs request.form Confusion"
        path: "/vuln/confusion/args-form"
        severity: "high"
        cvss_score: 7.5
        tags: ["parameter-pollution", "data-source", "confusion"]
        description: "Inconsistent data source access leading to bypasses"
        impact: "Authentication bypass, authorization bypass"
        exploit_example: "Provide malicious data in query string to override form data"

      - id: "values-priority"
        title: "request.values Priority Issues"
        path: "/vuln/confusion/values-args"
        severity: "critical"
        cvss_score: 9.1
        tags: ["parameter-pollution", "priority", "merged-dict"]
        description: "Query parameters override POST data in merged access"
        impact: "Complete system compromise via parameter injection"
        exploit_example: "Use query parameters to override sensitive POST data"

      - id: "json-type-confusion"
        title: "JSON Type Confusion"
        path: "/vuln/confusion/json-type"
        severity: "medium"
        cvss_score: 5.3
        tags: ["json", "type-validation", "deserialization"]
        description: "Missing type validation in JSON processing"
        impact: "Type confusion leading to unexpected behavior"
        exploit_example: "Send array instead of object to bypass validation"

  dos:
    title: "Denial of Service"
    description: "Resource exhaustion and performance degradation attacks"
    examples:
      - id: "regex-cpu-exhaustion"
        title: "Regex CPU Exhaustion"
        path: "/vuln/dos/re-cpu"
        severity: "medium"
        cvss_score: 5.3
        tags: ["regex", "cpu", "exhaustion", "redos"]
        description: "Evil regex patterns causing exponential time complexity"
        impact: "Service unavailability, CPU exhaustion"
        exploit_example: "Craft regex with catastrophic backtracking"

      - id: "memory-exhaustion"
        title: "Memory Exhaustion via Uploads"
        path: "/vuln/dos/memory-upload"
        severity: "high"
        cvss_score: 7.5
        tags: ["memory", "upload", "exhaustion", "resources"]
        description: "Unrestricted file uploads consuming server memory"
        impact: "Memory exhaustion, service crash"
        exploit_example: "Upload extremely large files without size limits"

  injection:
    title: "Injection Attacks"
    description: "Code and command injection vulnerabilities"
    examples:
      - id: "template-injection"
        title: "Template Injection"
        path: "/vuln/injection/template"
        severity: "critical"
        cvss_score: 9.8
        tags: ["template", "injection", "rce", "ssti"]
        description: "Server-side template injection leading to RCE"
        impact: "Remote code execution, complete compromise"
        exploit_example: "Inject template code in user-controlled input"

# Cross-references for comparison
comparisons:
  routing_patterns:
    title: "Routing Pattern Comparison"
    frameworks: ["flask", "django", "express", "fastapi"]
    description: "Compare routing syntax and capabilities across frameworks"

  data_access:
    title: "Data Access Pattern Comparison"
    frameworks: ["flask", "django", "express", "fastapi"]
    description: "Compare request data access patterns across frameworks"

# Educational content organization
learning_paths:
  beginner:
    title: "Beginner Learning Path"
    description: "Start with basic concepts and safe patterns"
    sequence:
      - "basic-routing"
      - "form-data"
      - "query-parameters"
      - "json-requests"

  intermediate:
    title: "Intermediate Learning Path"
    description: "Explore advanced features and security considerations"
    sequence:
      - "route-converters"
      - "merged-sources"
      - "middleware"
      - "error-handling"

  security_focused:
    title: "Security-Focused Learning Path"
    description: "Focus on security implications and vulnerability patterns"
    sequence:
      - "args-form-confusion"
      - "values-priority"
      - "template-injection"
      - "regex-cpu-exhaustion"

# Testing and validation metadata
test_scenarios:
  - id: "parameter-pollution"
    title: "Parameter Pollution Testing"
    description: "Test various parameter pollution scenarios"
    endpoints:
      - "/vuln/confusion/args-form"
      - "/vuln/confusion/values-args"
    test_cases:
      - "GET /endpoint?param=good POST param=evil"
      - "GET /endpoint?param=evil"
      - "POST param=evil"

  - id: "type-confusion"
    title: "Type Confusion Testing"
    description: "Test type coercion and validation bypasses"
    endpoints:
      - "/vuln/confusion/json-type"
    test_cases:
      - "POST {'user_id': '123'}"
      - "POST {'user_id': ['123', '456']}"
      - "POST {'user_id': {'nested': 'evil'}}"
